<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="candle-nn"><title>diffusion_rs_common::nn - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-6b053e98.ttf.woff2,FiraSans-Regular-0fe48ade.woff2,FiraSans-Medium-e1aa3f0a.woff2,SourceCodePro-Regular-8badfe75.ttf.woff2,SourceCodePro-Semibold-aa29a496.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../../static.files/normalize-9960930a.css"><link rel="stylesheet" href="../../static.files/rustdoc-46132b98.css"><meta name="rustdoc-vars" data-root-path="../../" data-static-root-path="../../static.files/" data-current-crate="diffusion_rs_common" data-themes="" data-resource-suffix="" data-rustdoc-version="1.85.1 (4eb161250 2025-03-15)" data-channel="1.85.1" data-search-js="search-75f5ac3e.js" data-settings-js="settings-0f613d39.js" ><script src="../../static.files/storage-59e33391.js"></script><script defer src="../sidebar-items.js"></script><script defer src="../../static.files/main-5f194d8c.js"></script><noscript><link rel="stylesheet" href="../../static.files/noscript-893ab5e7.css"></noscript><link rel="alternate icon" type="image/png" href="../../static.files/favicon-32x32-6580c154.png"><link rel="icon" type="image/svg+xml" href="../../static.files/favicon-044be391.svg"></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../../diffusion_rs_common/index.html">diffusion_<wbr>rs_<wbr>common</a><span class="version">0.1.0</span></h2></div><div class="sidebar-elems"><section id="rustdoc-toc"><h2 class="location"><a href="#">Module nn</a></h2><h3><a href="#">Sections</a></h3><ul class="block top-toc"><li><a href="#other-crates" title="Other Crates">Other Crates</a></li></ul><h3><a href="#reexports">Module Items</a></h3><ul class="block"><li><a href="#reexports" title="Re-exports">Re-exports</a></li><li><a href="#modules" title="Modules">Modules</a></li></ul></section><div id="rustdoc-modnav"><h2 class="in-crate"><a href="../index.html">In crate diffusion_<wbr>rs_<wbr>common</a></h2></div></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><span class="rustdoc-breadcrumbs"><a href="../index.html">diffusion_rs_common</a></span><h1>Module <span>nn</span><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><rustdoc-toolbar></rustdoc-toolbar><span class="sub-heading"><a class="src" href="../../src/diffusion_rs_common/nn/mod.rs.html#1-64">Source</a> </span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>candle-nn</p>
<h3 id="other-crates"><a class="doc-anchor" href="#other-crates">ยง</a>Other Crates</h3>
<p>Candle consists of a number of crates. This crate holds structs and functions
that allow you to build and train neural nets. You may wish
to look at the docs for the other crates which can be found here:</p>
<ul>
<li><a href="https://docs.rs/candle-core/">candle-core</a>. Core Datastructures and DataTypes.</li>
<li><a href="https://docs.rs/candle-nn/">candle-nn</a>. Building blocks for Neural Nets.</li>
<li><a href="https://docs.rs/candle-datasets/">candle-datasets</a>. Rust access to commonly used Datasets like MNIST.</li>
<li><a href="https://docs.rs/candle-examples/">candle-examples</a>. Examples of Candle in Use.</li>
<li><a href="https://docs.rs/candle-onnx/">candle-onnx</a>. Loading and using ONNX models.</li>
<li><a href="https://docs.rs/candle-pyo3/">candle-pyo3</a>. Access to Candle from Python.</li>
<li><a href="https://docs.rs/candle-transformers/">candle-transformers</a>. Candle implemntation of many published transformer models.</li>
</ul>
</div></details><h2 id="reexports" class="section-header">Re-exports<a href="#reexports" class="anchor">ยง</a></h2><ul class="item-table"><li><div class="item-name" id="reexport.prelu"><code>pub use activation::<a class="fn" href="activation/fn.prelu.html" title="fn diffusion_rs_common::nn::activation::prelu">prelu</a>;</code></div></li><li><div class="item-name" id="reexport.Activation"><code>pub use activation::<a class="enum" href="activation/enum.Activation.html" title="enum diffusion_rs_common::nn::activation::Activation">Activation</a>;</code></div></li><li><div class="item-name" id="reexport.PReLU"><code>pub use activation::<a class="struct" href="activation/struct.PReLU.html" title="struct diffusion_rs_common::nn::activation::PReLU">PReLU</a>;</code></div></li><li><div class="item-name" id="reexport.scaled_dot_product_attention"><code>pub use attention::<a class="fn" href="attention/fn.scaled_dot_product_attention.html" title="fn diffusion_rs_common::nn::attention::scaled_dot_product_attention">scaled_dot_product_attention</a>;</code></div></li><li><div class="item-name" id="reexport.batch_norm"><code>pub use batch_norm::<a class="fn" href="batch_norm/fn.batch_norm.html" title="fn diffusion_rs_common::nn::batch_norm::batch_norm">batch_norm</a>;</code></div></li><li><div class="item-name" id="reexport.BatchNorm"><code>pub use batch_norm::<a class="struct" href="batch_norm/struct.BatchNorm.html" title="struct diffusion_rs_common::nn::batch_norm::BatchNorm">BatchNorm</a>;</code></div></li><li><div class="item-name" id="reexport.BatchNormConfig"><code>pub use batch_norm::<a class="struct" href="batch_norm/struct.BatchNormConfig.html" title="struct diffusion_rs_common::nn::batch_norm::BatchNormConfig">BatchNormConfig</a>;</code></div></li><li><div class="item-name" id="reexport.conv1d"><code>pub use conv::<a class="fn" href="conv/fn.conv1d.html" title="fn diffusion_rs_common::nn::conv::conv1d">conv1d</a>;</code></div></li><li><div class="item-name" id="reexport.conv1d_no_bias"><code>pub use conv::<a class="fn" href="conv/fn.conv1d_no_bias.html" title="fn diffusion_rs_common::nn::conv::conv1d_no_bias">conv1d_no_bias</a>;</code></div></li><li><div class="item-name" id="reexport.conv2d"><code>pub use conv::<a class="fn" href="conv/fn.conv2d.html" title="fn diffusion_rs_common::nn::conv::conv2d">conv2d</a>;</code></div></li><li><div class="item-name" id="reexport.conv2d_no_bias"><code>pub use conv::<a class="fn" href="conv/fn.conv2d_no_bias.html" title="fn diffusion_rs_common::nn::conv::conv2d_no_bias">conv2d_no_bias</a>;</code></div></li><li><div class="item-name" id="reexport.conv_transpose1d"><code>pub use conv::<a class="fn" href="conv/fn.conv_transpose1d.html" title="fn diffusion_rs_common::nn::conv::conv_transpose1d">conv_transpose1d</a>;</code></div></li><li><div class="item-name" id="reexport.conv_transpose1d_no_bias"><code>pub use conv::<a class="fn" href="conv/fn.conv_transpose1d_no_bias.html" title="fn diffusion_rs_common::nn::conv::conv_transpose1d_no_bias">conv_transpose1d_no_bias</a>;</code></div></li><li><div class="item-name" id="reexport.conv_transpose2d"><code>pub use conv::<a class="fn" href="conv/fn.conv_transpose2d.html" title="fn diffusion_rs_common::nn::conv::conv_transpose2d">conv_transpose2d</a>;</code></div></li><li><div class="item-name" id="reexport.conv_transpose2d_no_bias"><code>pub use conv::<a class="fn" href="conv/fn.conv_transpose2d_no_bias.html" title="fn diffusion_rs_common::nn::conv::conv_transpose2d_no_bias">conv_transpose2d_no_bias</a>;</code></div></li><li><div class="item-name" id="reexport.Conv1d"><code>pub use conv::<a class="struct" href="conv/struct.Conv1d.html" title="struct diffusion_rs_common::nn::conv::Conv1d">Conv1d</a>;</code></div></li><li><div class="item-name" id="reexport.Conv1dConfig"><code>pub use conv::<a class="struct" href="conv/struct.Conv1dConfig.html" title="struct diffusion_rs_common::nn::conv::Conv1dConfig">Conv1dConfig</a>;</code></div></li><li><div class="item-name" id="reexport.Conv2d"><code>pub use conv::<a class="struct" href="conv/struct.Conv2d.html" title="struct diffusion_rs_common::nn::conv::Conv2d">Conv2d</a>;</code></div></li><li><div class="item-name" id="reexport.Conv2dConfig"><code>pub use conv::<a class="struct" href="conv/struct.Conv2dConfig.html" title="struct diffusion_rs_common::nn::conv::Conv2dConfig">Conv2dConfig</a>;</code></div></li><li><div class="item-name" id="reexport.ConvTranspose1d"><code>pub use conv::<a class="struct" href="conv/struct.ConvTranspose1d.html" title="struct diffusion_rs_common::nn::conv::ConvTranspose1d">ConvTranspose1d</a>;</code></div></li><li><div class="item-name" id="reexport.ConvTranspose1dConfig"><code>pub use conv::<a class="struct" href="conv/struct.ConvTranspose1dConfig.html" title="struct diffusion_rs_common::nn::conv::ConvTranspose1dConfig">ConvTranspose1dConfig</a>;</code></div></li><li><div class="item-name" id="reexport.ConvTranspose2d"><code>pub use conv::<a class="struct" href="conv/struct.ConvTranspose2d.html" title="struct diffusion_rs_common::nn::conv::ConvTranspose2d">ConvTranspose2d</a>;</code></div></li><li><div class="item-name" id="reexport.ConvTranspose2dConfig"><code>pub use conv::<a class="struct" href="conv/struct.ConvTranspose2dConfig.html" title="struct diffusion_rs_common::nn::conv::ConvTranspose2dConfig">ConvTranspose2dConfig</a>;</code></div></li><li><div class="item-name" id="reexport.embedding"><code>pub use embedding::<a class="fn" href="embedding/fn.embedding.html" title="fn diffusion_rs_common::nn::embedding::embedding">embedding</a>;</code></div></li><li><div class="item-name" id="reexport.Embedding"><code>pub use embedding::<a class="struct" href="embedding/struct.Embedding.html" title="struct diffusion_rs_common::nn::embedding::Embedding">Embedding</a>;</code></div></li><li><div class="item-name" id="reexport.func"><code>pub use func::<a class="fn" href="func/fn.func.html" title="fn diffusion_rs_common::nn::func::func">func</a>;</code></div></li><li><div class="item-name" id="reexport.func_t"><code>pub use func::<a class="fn" href="func/fn.func_t.html" title="fn diffusion_rs_common::nn::func::func_t">func_t</a>;</code></div></li><li><div class="item-name" id="reexport.Func"><code>pub use func::<a class="struct" href="func/struct.Func.html" title="struct diffusion_rs_common::nn::func::Func">Func</a>;</code></div></li><li><div class="item-name" id="reexport.FuncT"><code>pub use func::<a class="struct" href="func/struct.FuncT.html" title="struct diffusion_rs_common::nn::func::FuncT">FuncT</a>;</code></div></li><li><div class="item-name" id="reexport.group_norm"><code>pub use group_norm::<a class="fn" href="group_norm/fn.group_norm.html" title="fn diffusion_rs_common::nn::group_norm::group_norm">group_norm</a>;</code></div></li><li><div class="item-name" id="reexport.GroupNorm"><code>pub use group_norm::<a class="struct" href="group_norm/struct.GroupNorm.html" title="struct diffusion_rs_common::nn::group_norm::GroupNorm">GroupNorm</a>;</code></div></li><li><div class="item-name" id="reexport.Init"><code>pub use init::<a class="enum" href="init/enum.Init.html" title="enum diffusion_rs_common::nn::init::Init">Init</a>;</code></div></li><li><div class="item-name" id="reexport.layer_norm"><code>pub use layer_norm::<a class="fn" href="layer_norm/fn.layer_norm.html" title="fn diffusion_rs_common::nn::layer_norm::layer_norm">layer_norm</a>;</code></div></li><li><div class="item-name" id="reexport.rms_norm_non_quant"><code>pub use layer_norm::<a class="fn" href="layer_norm/fn.rms_norm_non_quant.html" title="fn diffusion_rs_common::nn::layer_norm::rms_norm_non_quant">rms_norm_non_quant</a>;</code></div></li><li><div class="item-name" id="reexport.rms_norm_quant"><code>pub use layer_norm::<a class="fn" href="layer_norm/fn.rms_norm_quant.html" title="fn diffusion_rs_common::nn::layer_norm::rms_norm_quant">rms_norm_quant</a>;</code></div></li><li><div class="item-name" id="reexport.LayerNorm"><code>pub use layer_norm::<a class="struct" href="layer_norm/struct.LayerNorm.html" title="struct diffusion_rs_common::nn::layer_norm::LayerNorm">LayerNorm</a>;</code></div></li><li><div class="item-name" id="reexport.LayerNormConfig"><code>pub use layer_norm::<a class="struct" href="layer_norm/struct.LayerNormConfig.html" title="struct diffusion_rs_common::nn::layer_norm::LayerNormConfig">LayerNormConfig</a>;</code></div></li><li><div class="item-name" id="reexport.RmsNorm"><code>pub use layer_norm::<a class="struct" href="layer_norm/struct.RmsNorm.html" title="struct diffusion_rs_common::nn::layer_norm::RmsNorm">RmsNorm</a>;</code></div></li><li><div class="item-name" id="reexport.linear"><code>pub use linear::<a class="fn" href="linear/fn.linear.html" title="fn diffusion_rs_common::nn::linear::linear">linear</a>;</code></div></li><li><div class="item-name" id="reexport.linear_b"><code>pub use linear::<a class="fn" href="linear/fn.linear_b.html" title="fn diffusion_rs_common::nn::linear::linear_b">linear_b</a>;</code></div></li><li><div class="item-name" id="reexport.linear_no_bias"><code>pub use linear::<a class="fn" href="linear/fn.linear_no_bias.html" title="fn diffusion_rs_common::nn::linear::linear_no_bias">linear_no_bias</a>;</code></div></li><li><div class="item-name" id="reexport.Linear"><code>pub use linear::<a class="struct" href="linear/struct.Linear.html" title="struct diffusion_rs_common::nn::linear::Linear">Linear</a>;</code></div></li><li><div class="item-name" id="reexport.kvconcat"><code>pub use ops::<a class="fn" href="ops/fn.kvconcat.html" title="fn diffusion_rs_common::nn::ops::kvconcat">kvconcat</a>;</code></div></li><li><div class="item-name" id="reexport.Dropout"><code>pub use ops::<a class="struct" href="ops/struct.Dropout.html" title="struct diffusion_rs_common::nn::ops::Dropout">Dropout</a>;</code></div></li><li><div class="item-name" id="reexport.AdamW"><code>pub use optim::<a class="struct" href="optim/struct.AdamW.html" title="struct diffusion_rs_common::nn::optim::AdamW">AdamW</a>;</code></div></li><li><div class="item-name" id="reexport.Optimizer"><code>pub use optim::<a class="trait" href="optim/trait.Optimizer.html" title="trait diffusion_rs_common::nn::optim::Optimizer">Optimizer</a>;</code></div></li><li><div class="item-name" id="reexport.ParamsAdamW"><code>pub use optim::<a class="struct" href="optim/struct.ParamsAdamW.html" title="struct diffusion_rs_common::nn::optim::ParamsAdamW">ParamsAdamW</a>;</code></div></li><li><div class="item-name" id="reexport.SGD"><code>pub use optim::<a class="struct" href="optim/struct.SGD.html" title="struct diffusion_rs_common::nn::optim::SGD">SGD</a>;</code></div></li><li><div class="item-name" id="reexport.gru"><code>pub use rnn::<a class="fn" href="rnn/fn.gru.html" title="fn diffusion_rs_common::nn::rnn::gru">gru</a>;</code></div></li><li><div class="item-name" id="reexport.lstm"><code>pub use rnn::<a class="fn" href="rnn/fn.lstm.html" title="fn diffusion_rs_common::nn::rnn::lstm">lstm</a>;</code></div></li><li><div class="item-name" id="reexport.GRUConfig"><code>pub use rnn::<a class="struct" href="rnn/struct.GRUConfig.html" title="struct diffusion_rs_common::nn::rnn::GRUConfig">GRUConfig</a>;</code></div></li><li><div class="item-name" id="reexport.LSTMConfig"><code>pub use rnn::<a class="struct" href="rnn/struct.LSTMConfig.html" title="struct diffusion_rs_common::nn::rnn::LSTMConfig">LSTMConfig</a>;</code></div></li><li><div class="item-name" id="reexport.GRU"><code>pub use rnn::<a class="struct" href="rnn/struct.GRU.html" title="struct diffusion_rs_common::nn::rnn::GRU">GRU</a>;</code></div></li><li><div class="item-name" id="reexport.LSTM"><code>pub use rnn::<a class="struct" href="rnn/struct.LSTM.html" title="struct diffusion_rs_common::nn::rnn::LSTM">LSTM</a>;</code></div></li><li><div class="item-name" id="reexport.RNN"><code>pub use rnn::<a class="trait" href="rnn/trait.RNN.html" title="trait diffusion_rs_common::nn::rnn::RNN">RNN</a>;</code></div></li><li><div class="item-name" id="reexport.RotaryEmbedding"><code>pub use rope::<a class="struct" href="rope/struct.RotaryEmbedding.html" title="struct diffusion_rs_common::nn::rope::RotaryEmbedding">RotaryEmbedding</a>;</code></div></li><li><div class="item-name" id="reexport.seq"><code>pub use sequential::<a class="fn" href="sequential/fn.seq.html" title="fn diffusion_rs_common::nn::sequential::seq">seq</a>;</code></div></li><li><div class="item-name" id="reexport.Sequential"><code>pub use sequential::<a class="struct" href="sequential/struct.Sequential.html" title="struct diffusion_rs_common::nn::sequential::Sequential">Sequential</a>;</code></div></li><li><div class="item-name" id="reexport.VarBuilder"><code>pub use var_builder::<a class="type" href="var_builder/type.VarBuilder.html" title="type diffusion_rs_common::nn::var_builder::VarBuilder">VarBuilder</a>;</code></div></li><li><div class="item-name" id="reexport.VarMap"><code>pub use var_map::<a class="struct" href="var_map/struct.VarMap.html" title="struct diffusion_rs_common::nn::var_map::VarMap">VarMap</a>;</code></div></li><li><div class="item-name" id="reexport.Module"><code>pub use crate::core::<a class="trait" href="../core/trait.Module.html" title="trait diffusion_rs_common::core::Module">Module</a>;</code></div></li><li><div class="item-name" id="reexport.ModuleT"><code>pub use crate::core::<a class="trait" href="../core/trait.ModuleT.html" title="trait diffusion_rs_common::core::ModuleT">ModuleT</a>;</code></div></li></ul><h2 id="modules" class="section-header">Modules<a href="#modules" class="anchor">ยง</a></h2><ul class="item-table"><li><div class="item-name"><a class="mod" href="activation/index.html" title="mod diffusion_rs_common::nn::activation">activation</a></div><div class="desc docblock-short">Activation Functions</div></li><li><div class="item-name"><a class="mod" href="attention/index.html" title="mod diffusion_rs_common::nn::attention">attention</a></div></li><li><div class="item-name"><a class="mod" href="batch_norm/index.html" title="mod diffusion_rs_common::nn::batch_norm">batch_<wbr>norm</a></div><div class="desc docblock-short">Batch Normalization.</div></li><li><div class="item-name"><a class="mod" href="conv/index.html" title="mod diffusion_rs_common::nn::conv">conv</a></div><div class="desc docblock-short">Convolution Layers.</div></li><li><div class="item-name"><a class="mod" href="embedding/index.html" title="mod diffusion_rs_common::nn::embedding">embedding</a></div><div class="desc docblock-short">Embedding Layer.</div></li><li><div class="item-name"><a class="mod" href="encoding/index.html" title="mod diffusion_rs_common::nn::encoding">encoding</a></div><div class="desc docblock-short">Encoding Utilities. (e.g., one-hot/cold encoding)</div></li><li><div class="item-name"><a class="mod" href="func/index.html" title="mod diffusion_rs_common::nn::func">func</a></div><div class="desc docblock-short">Layers defined by closures.</div></li><li><div class="item-name"><a class="mod" href="group_norm/index.html" title="mod diffusion_rs_common::nn::group_norm">group_<wbr>norm</a></div><div class="desc docblock-short">Group Normalization.</div></li><li><div class="item-name"><a class="mod" href="init/index.html" title="mod diffusion_rs_common::nn::init">init</a></div><div class="desc docblock-short">Variable initialization.</div></li><li><div class="item-name"><a class="mod" href="kv_cache/index.html" title="mod diffusion_rs_common::nn::kv_cache">kv_<wbr>cache</a></div><div class="desc docblock-short">Cache Implementations</div></li><li><div class="item-name"><a class="mod" href="layer_norm/index.html" title="mod diffusion_rs_common::nn::layer_norm">layer_<wbr>norm</a></div><div class="desc docblock-short">Layer Normalization.</div></li><li><div class="item-name"><a class="mod" href="linear/index.html" title="mod diffusion_rs_common::nn::linear">linear</a></div><div class="desc docblock-short">Linear layer</div></li><li><div class="item-name"><a class="mod" href="loss/index.html" title="mod diffusion_rs_common::nn::loss">loss</a></div><div class="desc docblock-short">Loss Calculations</div></li><li><div class="item-name"><a class="mod" href="ops/index.html" title="mod diffusion_rs_common::nn::ops">ops</a></div><div class="desc docblock-short">Tensor ops.</div></li><li><div class="item-name"><a class="mod" href="optim/index.html" title="mod diffusion_rs_common::nn::optim">optim</a></div><div class="desc docblock-short">Various optimization algorithms.</div></li><li><div class="item-name"><a class="mod" href="rnn/index.html" title="mod diffusion_rs_common::nn::rnn">rnn</a></div><div class="desc docblock-short">Recurrent Neural Networks</div></li><li><div class="item-name"><a class="mod" href="rope/index.html" title="mod diffusion_rs_common::nn::rope">rope</a></div></li><li><div class="item-name"><a class="mod" href="rotary_emb/index.html" title="mod diffusion_rs_common::nn::rotary_emb">rotary_<wbr>emb</a></div><div class="desc docblock-short">Rotary Embeddings</div></li><li><div class="item-name"><a class="mod" href="sequential/index.html" title="mod diffusion_rs_common::nn::sequential">sequential</a></div><div class="desc docblock-short">Sequential Layer</div></li><li><div class="item-name"><a class="mod" href="var_builder/index.html" title="mod diffusion_rs_common::nn::var_builder">var_<wbr>builder</a></div><div class="desc docblock-short">A <code>VarBuilder</code> is used to retrieve variables used by a model. These variables can either come
from a pre-trained checkpoint, e.g. using <code>VarBuilder::from_mmaped_safetensors</code>, or initialized
for training, e.g. using <code>VarBuilder::from_varmap</code>.</div></li><li><div class="item-name"><a class="mod" href="var_map/index.html" title="mod diffusion_rs_common::nn::var_map">var_map</a></div></li></ul></section></div></main></body></html>